### 创建高性能的索引

***
5.1 索引基础
    特点： 只能高效的使用所有的最左前缀列
    5.1.1 索引的类型
    索引是在存储引擎层实现的，而不是服务器层实现的。
    * B-Tree 索引，  
    很多存储引擎使用的是 B+Tree,每一个叶子节点都包含指向下一个叶子节点的指针，
    从而方便叶子节点的范围遍历。  
    ![Innodb索引如何工作](img/建立在B+Tree的索引.jpg)
    * 哈希索引(hash index)
       只存在memory 引擎    
    * 空间数据索引（R-Tree）  
    * 全文索引  
    * 分行树索引  
    * 聚簇索引  
    * 覆盖索引  
***
5.2 索引的优点  
    * 评价索引的好坏（三星系统）  
    1. 索引极大减少了服务器需要扫描的数据量  
    2. 索引可以帮助服务器避免排序和临时表
    3. 索引可以将随机I/O变成顺序I/O
***
5.3 高性能的索引策略   
    5.3.1 独立的列  
    5.3.2 前缀索引和索引选择  
    索引选择性： 不重复的索引值和数据表的记录总数的比值 
    * 当用字符串当索引时，会使用前缀索引来代替列索引  
    参考：通过计算完整列的选择性 和 前缀列的选择 两个做比较  
    5.3.3 多列索引  
    * 注意点： 不再在每个列都建一个索引，需要优化的点在 优化索引列的顺序，或创建一个全覆盖索引。  
    * 索引合并。  
    * 查询会对两个单列索引扫描合并。有三个算法变种。OR条件的联合，AND条件的相交，组合前两种情况的联合和相交  
    5.3.5 聚簇索引  
    * 聚簇索引事一种数据存储方式，InnoDB的聚簇索引是在同一个结构中保存了B-Tree索引和数据行
    聚簇：数据行存储在索引的叶子页上（leaf page） 表示数据行和相邻的键值紧凑的存储在一起。
    * 叶子页包含了行的全部数据，节点页包含了索引列。
    * mysql是用过主键来作为聚簇索引
    ![innodb主键分布](img/Innodb_主键分布.jpg)
    Innodb的二级索引的叶子节点，存储的不是”行指针“，而是主键值，以此作为指向行的指针。
    优点：减少行移动或者数据页分裂时，二级索引的维护工作。 Innodb再移动行时无须更新二级索引的这个指针。
    缺点：使用主键当行指针会让二级索引占用更多的空间。
    
***
mysql的join操作，是在内存进行的吗